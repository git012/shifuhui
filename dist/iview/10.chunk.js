webpackJsonp([10],{1001:function(t,e,a){a(1156);var i=a(66)(a(1082),a(1271),null,null);i.options.__file="F:\\changhaochen\\GitHub\\shifuhui\\src\\views\\news\\news.vue",i.esModule&&Object.keys(i.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] news.vue: functional components are not supported with templates, they should use render functions."),t.exports=i.exports},1081:function(t,e,a){"use strict";(function(t){function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(155),s=i(r),n=a(100),o=i(n),d=a(231),u=i(d);e.default={name:"news_add",data:function(){return{editorOption:{modules:{toolbar:"#toolbar"}},Kind:{},uploadUrl:{},currentData:{},defaultData:{id:0,content:"",title:"",author:"",status:0,date_added:""},FormSubmiting:!1,save_loading:!1,addDataValidate:{title:[{required:!0,message:"请填写标题",trigger:"blur"}],author:[{required:!0,message:"请输入作者",trigger:"blur"}],content:[{required:!0,message:"请编辑内容",trigger:"blur"}]},editDataValidate:{title:[{required:!0,message:"请填写标题",trigger:"blur"}],author:[{required:!0,message:"请输入作者",trigger:"blur"}],content:[{required:!0,message:"请编辑内容",trigger:"blur"}]}}},props:["editData","editType"],computed:{dowhat:function(){return this.editType},editor:function(){return this.$refs.myTextEditor.quill},beEditData:function(){return this.editData},contentBody:function(){return this.currentData.content},currentDataValidate:function(){return"add"==this.doType?this.addDataValidate:this.editDataValidate},hasDataChange:function(){return!((0,s.default)(this.currentData)==(0,s.default)(this.editData))}},methods:{saveEdit:function(){var e=this;this.$refs.currentData.validate(function(a){if(a){e.switching=!0;var i={ssid:o.default.get("ssid"),title:e.currentData.title,author:e.currentData.author,content:e.currentData.content,status:1},r=u.default.apiRootPath+u.default.api.news.news_list.add;"edit"==e.dowhat&&(i.id=e.currentData.id,r=u.default.apiRootPath+u.default.api.news.news_list.edit);t.ajax({url:r,type:"POST",dataType:"json",data:i}).done(function(t){e.switching=!1,t?0==t.code?("add"==e.dowhat&&e.$emit("doWhat","list"),e.$Message.success("保存成功！")):u.default.showError({vm:e,data:t,errorMsg:""}):u.default.showError({vm:e,data:t,errorMsg:"请求失败"})}).fail(function(t,a,i){e.switching=!1,u.default.showError({vm:e,data:data,errorMsg:"服务器通讯失败"})})}})},init:function(){}},beforeMount:function(){},mounted:function(){var e=this;this.$store.state.KindEditor.create("#articleEditor",{ssid:o.default.get("ssid"),$:t,width:800,height:300,fieldName:"image",uploadJson:u.default.apiRootPath+u.default.api.public.editerUpload,allowFileManager:!1,items:["source","|","undo","redo","|","preview","print","template","code","cut","copy","paste","plainpaste","wordpaste","|","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","clearhtml","quickformat","selectall","|","fullscreen","/","formatblock","fontname","fontsize","|","forecolor","hilitecolor","bold","italic","underline","strikethrough","lineheight","removeformat","|","image","flash","media","insertfile","table","hr","emoticons","baidumap","pagebreak","anchor","link","unlink","|","about"],afterBlur:function(){e.currentData.content=this.html()}})},created:function(){this.beEditData.id?this.currentData=t.extend(!0,{},this.beEditData):this.currentData=t.extend(!0,{},this.defaultData)},deactivated:function(){},destroyed:function(){},activated:function(){},watch:{}}}).call(e,a(154))},1082:function(t,e,a){"use strict";(function(t){function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(231),s=i(r),n=a(116),o=i(n),d=a(1218),u=i(d),l=a(100),c=i(l);e.default={name:"news_list",components:{AddForm:u.default},data:function(){var t=this;return{tableOptions:{width:"100%"},kind:{},columns:[{title:"ID",align:"center",key:"id"},{title:"标题",key:"title"},{title:"发布人",align:"center",key:"author"},{title:"创建时间",align:"center",key:"date_added"},{title:"状态",key:"status",align:"center",render:function(t,e){var a="default",i="未发布";return 1==e.row.applicantStatus&&(a="green",i="已发布"),t("Tag",{props:{color:a,size:"small"}},i)}},{title:"操作",key:"action",width:150,align:"center",render:function(e,a){var i=e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.view(a.index)}}},"预览"),r=e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.doWhat("edit",a.index)}}},"修改"),s=e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.doWhat("delete",a.index)}}},"删除"),n=[i];return t.checkPower("edit")&&n.push(r),t.checkPower("delete")&&n.push(s),e("div",n)}}],doType:"list",switching:!1,tableData:[],page:{dataCount:0,pageCount:0,pageSize:10,pageNumber:1,pageSizeOpts:[10,20,50,100]},dataReady:0,searchData:{keyword:"",searchDate:[],startDate:"",endDate:"",type:0},searchValidata:{}}},computed:{getLoading:function(){return!(0==this.dataReady)},doName:function(){return"list"==this.doType?"资讯管理":"edit"==this.doType?"编辑资讯":"add"==this.doType?"添加资讯":"资讯详情"}},methods:{checkPower:function(t){return!!this.$store.state.Rights[s.default.api.news.news_list[t].MD5()]},doWhat:function(t,e){if(!this.checkPower(t))return void this.$Message.warning("对不起，您没有此操作权限！");this.switching=!0,"add"==t&&(this.resetCurrentData(),this.doType="add"),"edit"==t&&(this.showEdit(e),this.doType="edit"),"delete"==t&&this.delete(e),"review"==t&&this.changeStatus(e),"list"==t&&(this.resetCurrentData(),this.dataReady+=1,this.init(),this.doType="list"),this.switching=!1},view:function(t){var e=s.default.api.news.news_list.review+this.tableData[t].id;window.open(e)},showEdit:function(e){this.currentData=t.extend(!0,{},this.tableData[e]),this.doType="edit"},resetCurrentData:function(){this.currentData=t.extend(!0,{},this.defaultData)},changePage:function(t){this.page.pageNumber=t,this.search(t)},changePageSize:function(t){this.page.pageSize=t,this.page.pageCount=Math.ceil(this.page.dataCount/this.page.pageSize),this.search()},resetSearch:function(){this.searchData={keyword:"",searchDate:[],startDate:"",endDate:"",type:0},this.page.pageNumber=1,this.dataReady++,this.init()},search:function(t){this.searchData.searchDate.length&&(this.searchData.startDate=o.default.FormatDate(this.searchData.searchDate[0],"yyyy-MM-dd"),this.searchData.endDate=o.default.FormatDate(this.searchData.searchDate[1],"yyyy-MM-dd")),this.page.pageNumber=1,t&&(this.page.pageNumber=t),this.doWhat("list")},init:function(){this.getList()},getList:function(){var e=this,a={ssid:c.default.get("ssid"),page:this.page.pageNumber,pageSize:this.page.pageSize};""!=this.searchData.keyword&&(a.search=o.default.trim(this.searchData.keyword)),""!=this.searchData.type&&(a.type=this.searchData.type),t.ajax({url:s.default.apiRootPath+s.default.api.news.news_list.list,type:"POST",dataType:"json",data:a}).done(function(t){e.dataReady--,t?0==t.code?(e.page.dataCount=t.data.count,e.page.pageCount=Math.ceil(e.page.dataCount/e.page.pageSize),e.tableData=t.data.list):s.default.showError({vm:e,data:t,errorMsg:""}):s.default.showError({vm:e,data:t,errorMsg:"请求失败"})}).fail(function(t,a,i){e.dataReady--,s.default.showError({vm:e,errorMsg:"服务器通讯失败"})})},delete:function(e){var a=this;if(this.tableData[e].id){t.ajax({url:s.default.apiRootPath+s.default.api.news.news_list.delete,type:"POST",dataType:"json",data:function(){return{ssid:c.default.get("ssid"),id:a.tableData[e].id,status:0}}()}).done(function(t){t?0==t.code?(a.$Message.success("删除成功!"),a.tableData.splice(e,1)):s.default.showError({vm:a,data:t,errorMsg:""}):s.default.showError({vm:a,data:t,errorMsg:"请求失败"})}).fail(function(t,e,i){s.default.showError({vm:a,errorMsg:"服务器通讯失败"})})}}},updated:function(){},mounted:function(){},deactivated:function(){},activated:function(){this.doWhat("list")}}}).call(e,a(154))},1156:function(t,e){},1157:function(t,e){},1218:function(t,e,a){a(1157);var i=a(66)(a(1081),a(1274),null,null);i.options.__file="F:\\changhaochen\\GitHub\\shifuhui\\src\\views\\news\\add.vue",i.esModule&&Object.keys(i.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] add.vue: functional components are not supported with templates, they should use render functions."),t.exports=i.exports},1271:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("p",{staticClass:"hasButtonP",attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"person"}}),t._v("\n            "+t._s(t.doName)+"\n            "),t.checkPower("list")&&"list"!=t.doType?a("Button",{staticClass:"add-btu margin-left-10",attrs:{type:"warning",size:"small"},on:{click:function(e){t.doWhat("list")}}},[t._v("返回列表\n            ")]):t._e(),t._v(" "),t.checkPower("add")&&"list"==t.doType?a("Button",{staticClass:"add-btu",attrs:{type:"primary",size:"small"},on:{click:function(e){t.doWhat("add")}}},[t._v("添加资讯\n            ")]):t._e()],1),t._v(" "),a("div",{staticClass:"doBox"},[t.switching?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),t._v(" "),"add"==t.doType||"edit"==t.doType?a("AddForm",{attrs:{editData:t.currentData,editType:t.doType},on:{doWhat:t.doWhat}}):t._e(),t._v(" "),"list"==t.doType?a("div",{staticClass:"ordler-list"},[a("div",{staticClass:"search-box"},[a("Form",{ref:"searchData",attrs:{model:t.searchData,rules:t.searchValidata,inline:""}},[a("FormItem",{attrs:{prop:"keyword"}},[a("Input",{attrs:{type:"text",placeholder:"输入搜索关键字"},model:{value:t.searchData.keyword,callback:function(e){t.$set(t.searchData,"keyword",e)},expression:"searchData.keyword"}},[a("Icon",{attrs:{slot:"prepend",type:"ios-eye"},slot:"prepend"})],1)],1),t._v(" "),a("FormItem",{attrs:{prop:"searchDate"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",placeholder:"请选择时间范围"},model:{value:t.searchData.searchDate,callback:function(e){t.$set(t.searchData,"searchDate",e)},expression:"searchData.searchDate"}})],1),t._v(" "),a("FormItem",[a("ButtonGroup",[a("Button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){t.search()}}},[t._v("搜索")]),t._v(" "),a("Button",{on:{click:t.resetSearch}},[t._v("清空")])],1)],1)],1)],1),t._v(" "),a("Table",{staticClass:"small_table",attrs:{border:"",columns:t.columns,loading:t.getLoading,data:t.tableData}}),t._v(" "),a("div",{staticClass:"page-box"},[t.page.dataCount>10?a("Page",{attrs:{total:t.page.dataCount,"show-total":"","page-size-opts":t.page.pageSizeOpts,"page-size":t.page.pageSize,"show-elevator":"",placement:"top","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}}):t._e()],1)],1):t._e()],1)])],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},1274:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Form",{ref:"currentData",attrs:{id:"editForm",model:t.currentData,"label-width":100,"label-position":"right",rules:t.currentDataValidate},on:{submit:t.saveEdit}},[a("FormItem",{attrs:{label:"标题：",prop:"title"}},[a("div",{staticStyle:{width:"500px"}},[a("Input",{model:{value:t.currentData.title,callback:function(e){t.$set(t.currentData,"title",e)},expression:"currentData.title"}})],1)]),t._v(" "),a("FormItem",{attrs:{label:"作者：",prop:"author"}},[a("div",{staticStyle:{display:"inline-block",width:"200px"}},[a("Input",{model:{value:t.currentData.author,callback:function(e){t.$set(t.currentData,"author",e)},expression:"currentData.author"}})],1)]),t._v(" "),a("FormItem",{attrs:{label:"内容：",prop:"content"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.currentData.content,expression:"currentData.content"}],attrs:{id:"articleEditor"},domProps:{value:t.currentData.content},on:{input:function(e){e.target.composing||t.$set(t.currentData,"content",e.target.value)}}})]),t._v(" "),a("div",[a("Button",{staticStyle:{width:"100px"},attrs:{type:"text"},on:{click:function(e){t.$emit("doWhat","list")}}},[t._v("取消")]),t._v(" "),a("Button",{staticStyle:{width:"100px"},attrs:{disable:t.hasDataChange,type:"primary",loading:t.save_loading},on:{click:function(e){t.saveEdit()}}},[t._v("保存")])],1)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0}});